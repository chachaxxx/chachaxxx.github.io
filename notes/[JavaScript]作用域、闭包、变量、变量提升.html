<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.作用域（Scope） | My Cata</title>
    <meta name="description" content="The description of the site.">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.2264d4e8.css" as="style"><link rel="preload" href="/assets/js/app.61f0c8a1.js" as="script"><link rel="preload" href="/assets/js/4.031c4c0e.js" as="script"><link rel="preload" href="/assets/js/38.16e9a483.js" as="script"><link rel="prefetch" href="/assets/js/1.2c06699e.js"><link rel="prefetch" href="/assets/js/10.69d76af3.js"><link rel="prefetch" href="/assets/js/11.059a4e31.js"><link rel="prefetch" href="/assets/js/12.c81d7cb5.js"><link rel="prefetch" href="/assets/js/13.444e4ec8.js"><link rel="prefetch" href="/assets/js/14.124d2bed.js"><link rel="prefetch" href="/assets/js/15.febf1378.js"><link rel="prefetch" href="/assets/js/16.446eca84.js"><link rel="prefetch" href="/assets/js/17.4367e345.js"><link rel="prefetch" href="/assets/js/18.9c5bf55a.js"><link rel="prefetch" href="/assets/js/19.73842072.js"><link rel="prefetch" href="/assets/js/20.ff54a6bc.js"><link rel="prefetch" href="/assets/js/21.cd6b4fbb.js"><link rel="prefetch" href="/assets/js/22.e976ee8a.js"><link rel="prefetch" href="/assets/js/23.0a9fb249.js"><link rel="prefetch" href="/assets/js/24.1b21c491.js"><link rel="prefetch" href="/assets/js/25.5b1348de.js"><link rel="prefetch" href="/assets/js/26.298c82d1.js"><link rel="prefetch" href="/assets/js/27.f0f6a4a0.js"><link rel="prefetch" href="/assets/js/28.846b0858.js"><link rel="prefetch" href="/assets/js/29.39bfed1a.js"><link rel="prefetch" href="/assets/js/3.9e8bbfcf.js"><link rel="prefetch" href="/assets/js/30.017396f1.js"><link rel="prefetch" href="/assets/js/31.36f79d24.js"><link rel="prefetch" href="/assets/js/32.3173e347.js"><link rel="prefetch" href="/assets/js/33.fcbffb8a.js"><link rel="prefetch" href="/assets/js/34.b471191f.js"><link rel="prefetch" href="/assets/js/35.a9871011.js"><link rel="prefetch" href="/assets/js/36.f3cad3f2.js"><link rel="prefetch" href="/assets/js/37.340f7814.js"><link rel="prefetch" href="/assets/js/39.8bb71add.js"><link rel="prefetch" href="/assets/js/40.f60ca09c.js"><link rel="prefetch" href="/assets/js/41.6c5d4837.js"><link rel="prefetch" href="/assets/js/42.7cb165b2.js"><link rel="prefetch" href="/assets/js/43.016f7d1f.js"><link rel="prefetch" href="/assets/js/44.50cc140b.js"><link rel="prefetch" href="/assets/js/45.cec45a65.js"><link rel="prefetch" href="/assets/js/46.44c8ce2f.js"><link rel="prefetch" href="/assets/js/47.7663057f.js"><link rel="prefetch" href="/assets/js/48.b63e4edc.js"><link rel="prefetch" href="/assets/js/49.1c04ecb0.js"><link rel="prefetch" href="/assets/js/5.e5b013c3.js"><link rel="prefetch" href="/assets/js/50.203149d1.js"><link rel="prefetch" href="/assets/js/51.e8d2808e.js"><link rel="prefetch" href="/assets/js/52.4bff45a3.js"><link rel="prefetch" href="/assets/js/53.d3bfe4fc.js"><link rel="prefetch" href="/assets/js/54.ece4d1bd.js"><link rel="prefetch" href="/assets/js/55.7bfc0aea.js"><link rel="prefetch" href="/assets/js/56.abfbcb0a.js"><link rel="prefetch" href="/assets/js/57.322cc0c7.js"><link rel="prefetch" href="/assets/js/58.8069b906.js"><link rel="prefetch" href="/assets/js/59.4af20640.js"><link rel="prefetch" href="/assets/js/6.ee007060.js"><link rel="prefetch" href="/assets/js/60.2bc64cd9.js"><link rel="prefetch" href="/assets/js/61.a8a49e1b.js"><link rel="prefetch" href="/assets/js/62.ba6d639c.js"><link rel="prefetch" href="/assets/js/63.85b52299.js"><link rel="prefetch" href="/assets/js/64.ae97ef4b.js"><link rel="prefetch" href="/assets/js/65.a9ec3ec1.js"><link rel="prefetch" href="/assets/js/7.445bd0ee.js"><link rel="prefetch" href="/assets/js/8.8f7c8e84.js"><link rel="prefetch" href="/assets/js/9.7e7cc3fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2264d4e8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">My Cata</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">作品集</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">笔记</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/guide/" class="nav-link">作品集</a></div><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">笔记</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/" class="sidebar-link">/notes/</a></li><li><a href="/notes/[Base]MVVM &amp;  MVC.html" class="sidebar-link">[Base]MVVM &amp;  MVC</a></li><li><a href="/notes/[Base]八股文.html" class="sidebar-link">[Base]八股文</a></li><li><a href="/notes/[Base]前端安全问题.html" class="sidebar-link">[Base]前端安全问题</a></li><li><a href="/notes/[Base]语言中所有的底层存储方式.html" class="sidebar-link">[Base]语言中所有的底层存储方式</a></li><li><a href="/notes/[Base]跨域以及解决方案.html" class="sidebar-link">[Base]跨域以及解决方案</a></li><li><a href="/notes/[Base]身份认证.html" class="sidebar-link">[Base]身份认证</a></li><li><a href="/notes/[Electtron]学习笔记.html" class="sidebar-link">[Electtron]学习笔记</a></li><li><a href="/notes/[HTML]HTML5.html" class="sidebar-link">[HTML]HTML5</a></li><li><a href="/notes/[HTML]语义化.html" class="sidebar-link">[HTML]语义化</a></li><li><a href="/notes/[JavaScript]ES6新特性.html" class="sidebar-link">[JavaScript]ES6新特性</a></li><li><a href="/notes/[JavaScript]EventLoop、宏任务和微任务.html" class="sidebar-link">[JavaScript]EventLoop、宏任务和微任务</a></li><li><a href="/notes/[JavaScript]Symbol.html" class="sidebar-link">[JavaScript]Symbol</a></li><li><a href="/notes/[JavaScript]this &amp; bind,apply,call 装饰器.html" class="sidebar-link">[JavaScript]this &amp; bind,apply,call 装饰器</a></li><li><a href="/notes/[JavaScript]事件流、事件委托、事件冒泡.html" class="sidebar-link">[JavaScript]事件流、事件委托、事件冒泡</a></li><li><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html" class="active sidebar-link">[JavaScript]作用域、闭包、变量、变量提升</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#函数预编译过程" class="sidebar-link">函数预编译过程</a></li><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#作用域链" class="sidebar-link">作用域链</a></li><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#执行上下文与作用域链" class="sidebar-link">执行上下文与作用域链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#闭包的应用" class="sidebar-link">闭包的应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#var的变量提升" class="sidebar-link">var的变量提升</a></li><li class="sidebar-sub-header"><a href="/notes/[JavaScript]作用域、闭包、变量、变量提升.html#函数声明提升" class="sidebar-link">函数声明提升</a></li></ul></li><li><a href="/notes/[JavaScript]原型、原型链、继承.html" class="sidebar-link">[JavaScript]原型、原型链、继承</a></li><li><a href="/notes/[JavaScript]常见数据处理积累.html" class="sidebar-link">[JavaScript]常见数据处理积累</a></li><li><a href="/notes/[JavaScript]异步.html" class="sidebar-link">[JavaScript]异步</a></li><li><a href="/notes/[JavaScript]正则表达式.html" class="sidebar-link">[JavaScript]正则表达式</a></li><li><a href="/notes/[JavaScript]深浅拷贝.html" class="sidebar-link">[JavaScript]深浅拷贝</a></li><li><a href="/notes/[Layout]响应式布局.html" class="sidebar-link">[Layout]响应式布局</a></li><li><a href="/notes/[Layout]界面兼容性.html" class="sidebar-link">[Layout]界面兼容性</a></li><li><a href="/notes/[Optimize]各种优化.html" class="sidebar-link">[Optimize]各种优化</a></li><li><a href="/notes/[Publish]webpack.html" class="sidebar-link">[Publish]webpack</a></li><li><a href="/notes/[Style]BFC.html" class="sidebar-link">[Style]BFC</a></li><li><a href="/notes/[Style]CSS3新特性.html" class="sidebar-link">[Style]CSS3新特性</a></li><li><a href="/notes/[Style]CSS预编译器对比.html" class="sidebar-link">[Style]CSS预编译器对比</a></li><li><a href="/notes/[Style]less.html" class="sidebar-link">[Style]less</a></li><li><a href="/notes/[Style]sass &amp; scss.html" class="sidebar-link">[Style]sass &amp; scss</a></li><li><a href="/notes/[Style]居中样式.html" class="sidebar-link">[Style]居中样式</a></li><li><a href="/notes/[Style]常见图形.html" class="sidebar-link">[Style]常见图形</a></li><li><a href="/notes/[Style]盒子模型与flex布局、栅格布局.html" class="sidebar-link">[Style]盒子模型与flex布局、栅格布局</a></li><li><a href="/notes/[TypeScript]学习笔记.html" class="sidebar-link">[TypeScript]学习笔记</a></li><li><a href="/notes/[UniAPP]与H5开发不同.html" class="sidebar-link">[UniAPP]与H5开发不同</a></li><li><a href="/notes/[Vue]Vue-router.html" class="sidebar-link">[Vue]Vue-router</a></li><li><a href="/notes/[Vue]Vuex.html" class="sidebar-link">[Vue]Vuex</a></li><li><a href="/notes/[Vue]小知识点.html" class="sidebar-link">[Vue]小知识点</a></li><li><a href="/notes/[Vue]指令.html" class="sidebar-link">[Vue]指令</a></li><li><a href="/notes/[Vue]生命周期.html" class="sidebar-link">[Vue]生命周期</a></li><li><a href="/notes/[Vue]组件通信方式.html" class="sidebar-link">[Vue]组件通信方式</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-作用域（scope）">1.作用域（Scope）</h1> <blockquote><p>作用域就是一个独立的区域，它可以让变量不会向外暴露出去。作用域最大的用处就是隔离变量。内层作用域可以访问外层作用域。一个作用域下可能包含若干个执行上下文。</p> <p><strong>ES6 之前 JavaScript 没有块级作用域,只有全局作用域和函数作用域</strong></p></blockquote> <ul><li><p>全局作用域（globalThis）、函数作用域 、块级作用域</p></li> <li><p>子作用域可以访问父作用域，通常是指沿着链式的作用域链向上查找直到全局作用于，而不能从父作用域引用子作用域中的变量和引用。</p></li> <li><p>每调用一次就会创建一个新的函数作用域，相互独立，调用完毕会被销毁。</p></li> <li><p>一个 <a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Function" target="_blank" rel="noopener noreferrer">Function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 将生成一个闭包（通常是返回一个函数引用），这个函数引用从外部作用域（在当前环境下）可以访问闭包内部的作用域。返回的变量讲存在函数实例的[[Scoped]]中。其他会被回收。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">&quot;bar in foo&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> str<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fun <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;bar in foo&quot;</span>
</code></pre></div></li></ul> <h2 id="函数预编译过程">函数预编译过程</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.创建AO对象</span>
<span class="token comment">// 2.形参、变量var声明</span>
<span class="token comment">// 3.实参赋值给形参</span>
<span class="token comment">// 4.函数体里找函数声明,值赋予函数体</span>
<span class="token comment">//    function a(){} 是函数声明 a = function(){} 不是函数声明，是赋值操作</span>
<span class="token comment">// eg.</span>
<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// function a(){}</span>
    <span class="token comment">// console.log(b) // error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
    <span class="token comment">// console.log(d) // error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token comment">// function a(){}</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span>
        <span class="token keyword">let</span> d <span class="token operator">=</span> <span class="token number">4</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function-variable function">c</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token number">321</span><span class="token punctuation">)</span>
<span class="token comment">// AO过程如下</span>
<span class="token constant">AO</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
    a<span class="token punctuation">:</span> <span class="token keyword">undefined</span> <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">&gt;</span>funciton <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    c<span class="token punctuation">:</span> <span class="token keyword">undefined</span> 
    e<span class="token punctuation">:</span> <span class="token keyword">undefined</span> <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token keyword">function</span> <span class="token function">e</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="作用域链">作用域链</h2> <p>当前作用域没有定义的变量，这成为自由变量 。</p> <p>自由变量一个变量一层一层向上寻找，若找到则为该值；若直到找到全局作用域还是没找到，就发生错误。</p> <p>这种一层一层的关系，就是作用域链 。静态作用域：函数内的自由变量取值<strong>要到创建这个函数的那个域”。 作用域中取值,这里强调的是“创建”，而不是“调用”</strong>。</p> <p>底层理解：作用域链会被存储到函数的隐藏属性**[[scope]]**中，js引擎可以访问。之中存储了函数预编译（函数执行的前一刻）对象AO，GO的集合。</p> <h2 id="执行上下文与作用域链">执行上下文与作用域链</h2> <p><a href="https://www.bilibili.com/video/BV1wD4y1D7Pp?from=search&amp;seid=2212534765957722610" target="_blank" rel="noopener noreferrer">js执行上下文与作用域<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>执行上下文是JavaScript代码执行的环境准备。</p> <p><strong>执行上下文在运行时确定，随时可能改变；作用域在定义时就确定，并且不会改变</strong>。</p> <p>执行上下文包括了作用域链，作用域链只是为函数内变量的访问定义了规则。</p> <p>创建执行上下文时会进行this绑定、创建词法环境和变量环境。</p> <ul><li><p><strong>词法环境</strong>是一种规范类型，基于 <code>ECMAScript</code> 代码的词法嵌套结构来定义<strong>标识符</strong>和具体变量和函数的关联。一个词法环境由<strong>环境记录器</strong>和一个可能的<strong>引用外部词法环境的空值</strong>组成。</p> <p>简单来说，词法环境是一种持有<strong>标识符—变量的映射</strong>的结构。（这里的<strong>标识符</strong>指的是变量/函数的名字，而<strong>变量</strong>是对实际对象[包含函数类型对象]或原始数据的引用）。</p> <p>或者也可以这样说，词法环境就是指相应代码块内标识符与变量值、函数值之间的关联关系的一种体现。</p></li> <li><p><strong>变量环境</strong>同样是一个词法环境，其环境记录器持有<strong>变量声明语句</strong>在执行上下文中创建的绑定关系。</p></li> <li><p>创建执行上下文：</p> <ul><li><p><strong>全局执行上下文</strong>： 这是默认的、最基础的执行上下文。不在任何函数中的代码都位于全局执行上下文中。它做了两件事：
1.创建一个全局对象，在浏览器中这个全局对象就是 window 对象。</p> <p>将 this指针指向这个全局对象。一个程序中只能存在一个全局执行上下文。</p></li> <li><p><strong>函数执行上下文</strong>： 每次调用函数时，都会为该函数创建一个新的执行上下文。每个函数都拥有自己的执行上下文，但是只有在函数被调用的时候才会被创建。一个程序中可以存在任意数量的函数执行上下文。每当一个新的执行上下文被创建，它都会按照特定的顺序执行一系列步骤，具体过程将在本文后面讨论。</p></li> <li><p><strong>Eval 函数执行上下文</strong>： 运行在 eval 函数中的代码也获得了自己的执行上下文，但由于 Javascript 开发人员不常用 eval函数，所以在这里不再讨论。 两者的区别</p></li></ul></li></ul> <h1 id="_2-闭包">2.闭包</h1> <blockquote><p>1「函数」和「函数内部能访问到的变量」的总和，就是一个闭包</p> <p>2  函数和对其词法环境的引用捆绑在一起，这样的组合就是闭包</p></blockquote> <p>一个函数作用域内的引用数据类型被外界占用，该函数形成不销毁的作用域。</p> <p>本质就是上级作用域内变量的生命周期，因为被下级作用域内引用，而没有被释放。就导致上级作用域内的变量，等到下级作用域执行完以后才正常得到释放。</p> <h3 id="闭包的应用">闭包的应用</h3> <p>1.立即调用函数，模仿块级作用域，避免块内的变量提升，防止污染全局环境。减少内存消耗。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'111'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>2.形成可访问的私有变量，进行函数封装。</p> <p>3.[节流防抖](./[JavaScript]this &amp; bind,apply,call 装饰器.md)</p> <p>4.柯里化实现:柯里化是一种将使用多个参数的一个函数转换成一系列使用一个参数的函数的技术</p> <div class="language-js extra-class"><pre class="language-js"><code>https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>jsrun<span class="token punctuation">.</span>net<span class="token operator">/</span>AbQKp<span class="token operator">/</span>edit
</code></pre></div><p>5.改善for循环中i共用一个作用域</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// var i 变量提示,为for循环外变量 恒定为3</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>

<span class="token comment">// 改良</span>
<span class="token comment">// 1.使用let</span>
<span class="token comment">// 2.使用事件循环机制和立即执行函数的私有作用域</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//   data[i] = function () {</span>
    <span class="token comment">//     console.log(i); </span>
    <span class="token comment">//   };</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="_3-声明变量">3.声明变量</h1> <blockquote><p><a href="https://en.wikipedia.org/wiki/Variable_(computer_science)" target="_blank" rel="noopener noreferrer">变量<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是数据的“命名存储”。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> message<span class="token punctuation">;</span>
message <span class="token operator">=</span> <span class="token string">'Hello!'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token string">'John'</span><span class="token punctuation">,</span> age <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">'Hello'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">NAME</span> <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span> <span class="token comment">// 声明一个常数（不变）变量，可以使用 const 而非 let：</span>
<span class="token comment">// error</span>
<span class="token keyword">let</span> <span class="token number">1</span>a<span class="token punctuation">;</span> <span class="token comment">// 不能以数字开始</span>
<span class="token keyword">let</span> my<span class="token operator">-</span>name<span class="token punctuation">;</span> <span class="token comment">// 连字符 '-' 不允许用于变量命名</span>
<span class="token keyword">let</span> <span class="token keyword">return</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// 不能使用保留字</span>
</code></pre></div><p>变量声明的三种方式：</p> <ol><li><code>let</code></li> <li><code>const</code> 常量不能修改</li> <li><code>var</code> 旧时</li></ol> <h2 id="var的变量提升">var的变量提升</h2> <ul><li><p>用 <code>var</code> 声明的变量，不是函数作用域就是全局作用域。它们在代码块外也是可见的（译注：也就是说，<code>var</code> 声明的变量只有函数作用域和全局作用域，没有块级作用域）。</p></li> <li><p>var可以被重新声明。</p></li> <li><p>“var” 声明的变量，可以在其声明语句前被使用。也即函数开始就处理var变量的初始化。<strong>声明会被提升，但是赋值不会。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hi<span class="token punctuation">)</span>
    <span class="token keyword">var</span> hi <span class="token operator">=</span>  <span class="token string">'Hello'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实际运行</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> hi
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hi<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
    hi <span class="token operator">=</span>  <span class="token string">'Hello'</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>立即调用函数表达式（IIFE）：可以立即调用一个函数，避免块内的变量提升，防止污染全局环境，同时允许公共访问方法，同时保留函数中定义的变量的隐私。弥补 var只有<strong>全局作用域</strong>和<strong>函数作用域</strong> 的这个缺陷。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// Uncaught ReferenceError: message is not defined</span>

<span class="token comment">// 变量提升 message已经声明</span>
<span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> message <span class="token operator">=</span> <span class="token string">'Hello In Block'</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token punctuation">}</span>
<span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h1 id="_4-声明函数">4.声明函数</h1> <p>函数是一种特殊的对象。</p> <p>一个容易理解的方式是把函数想象成可被调用的“行为对象（action object）。</p> <blockquote><ul><li><code>name</code> —— 函数的名字。通常取自函数定义，但如果函数定义时没设定函数名，JavaScript 会尝试通过函数的上下文猜一个函数名（例如把赋值的变量名取为函数名）。</li> <li><code>length</code> —— 函数定义时的入参的个数。Rest 参数不参与计数。</li></ul></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一般写法</span>
<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 命名函数表达式（NFE，Named Function Expression），指带有名字的函数表达式的术语。</span>
<span class="token keyword">let</span> <span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter">who</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>who<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>who<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;Guest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用 func 再次调用函数自身 * 用于在该函数内部进行自调用，例如递归调用等</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// &quot;new Function&quot; 语法</span>
<span class="token comment">// 使用 new Function 创建的函数，它的 [[Environment]] 指向全局词法环境，而不是函数所在的外部词法环境。因此，我们不能在 new Function 中直接使用外部变量。</span>
<span class="token comment">// 因此，此类函数无法访问外部（outer）变量，只能访问全局变量。</span>
<span class="token keyword">let</span> func <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">,</span> <span class="token operator">...</span>argN<span class="token punctuation">]</span><span class="token punctuation">,</span> functionBody<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="函数声明提升">函数声明提升</h2> <p>函数声明语句将会被提升到外部脚本或者外部函数作用域的顶部。同样的赋值不会提升。</p> <p>1.所有声明（变量和函数）都会被移动到各自作用域的最顶端，这个过程被称为<strong>提升</strong></p> <p>2.函数表达式等各种赋值操作并不会被提升</p> <p>3.函数优先原则</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -&gt;foo</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>bar2<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -&gt;Error: Cannot access 'bar' before initialization</span>
<span class="token function">bar2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-&gt;Eror: bar2 is not a function</span>
<span class="token comment">// 一般写法</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 具名表达式</span>
<span class="token keyword">let</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">bar2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实际上运行顺序</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> bar2
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -&gt;foo</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// -&gt;Error: Cannot access 'bar' before initialization</span>
<span class="token function">bar2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-&gt;Eror: bar2 is not a function</span>
<span class="token keyword">let</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">bar2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="_5-提升总结">5.提升总结</h1> <ul><li><p>有三种声明变量。let,var,const。</p> <ul><li><p>const用于常量定义，一旦定义就不能修改值。但引用对象可以改变对象的值。</p></li> <li><p>let在同一作用域只能声明一次，且按照作用域链向上找变量。没有提升，块级作用域有效。</p></li> <li><p>var可以重复声明，也按照作用域链向上找变量。块级作用域无效（类似if），存在变量提升，也即在作用域内提升到头部声明，但不处理赋值。对此有一种“立即执行函数”来进行var声明变量的块级作用域处理。</p></li></ul></li> <li><p>函数声明有三种方式，切函数声明提升。</p> <ul><li>一般声明 function a(){}</li> <li>具名声明 // 提升时未进行赋值 let a = function(){}</li> <li>New Function // 作用域为全局作用域 New Function(...args,func)</li></ul></li> <li><p>在同一作用域内，先进行函数声明的提升，在进行var声明变量的提升。赋值都不会被提升！</p></li></ul> <p>​</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/[JavaScript]事件流、事件委托、事件冒泡.html" class="prev">[JavaScript]事件流、事件委托、事件冒泡</a></span> <span class="next"><a href="/notes/[JavaScript]原型、原型链、继承.html">[JavaScript]原型、原型链、继承</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.61f0c8a1.js" defer></script><script src="/assets/js/4.031c4c0e.js" defer></script><script src="/assets/js/38.16e9a483.js" defer></script>
  </body>
</html>
